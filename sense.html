<script type="text/javascript">
    RED.nodes.registerType('sense-config',{
        category: 'config',
        defaults: {
            name: {value: "Sense Energy Monitor", required: true}
        },
        credentials: {
            email: {type:"text", validate: RED.validators.regex(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)},
            password: {type:"password"}
        },
        label: function() {
            return this.name;
        }
    });
    RED.nodes.registerType('sense-device-on',{
        category: 'sense',
        color: '#F9461C',
        defaults: {
            name: {value:""},
            device: {value:""},
            sense: {value: "", type:"sense-config", required:true}
        },
        inputs:1,
        outputs:2,
        icon: "sense.png",
        label: function() {
            return this.name||(this.device ? "is " + this.device + " on": false )||"sense device on";
        }
    });
    RED.nodes.registerType('sense-now',{
        category: 'sense',
        color: '#F9461C',
        defaults: {
            name: {value:""},
            sense: {value: "", type:"sense-config", required:true}
        },
        inputs:1,
        outputs:1,
        icon: "sense.png",
        label: function() {
            return this.name||"sense now";
        }
    });
    RED.nodes.registerType('sense-monitor',{
        category: 'sense',
        color: '#F9461C',
        defaults: {
            name: {value:""},
            sense: {value: "", type:"sense-config", required:true}
        },
        inputs:1,
        outputs:1,
        icon: "sense.png",
        label: function() {
            return this.name||"sense monitor";
        }
    });
    RED.nodes.registerType('sense-devices',{
        category: 'sense',
        color: '#F9461C',
        defaults: {
            name: {value:""},
            sense: {value: "", type:"sense-config", required:true}
        },
        inputs:1,
        outputs:1,
        icon: "sense.png",
        label: function() {
            return this.name||"all sense devices";
        }
    });
    RED.nodes.registerType('sense-update',{
        category: 'sense',
        color: '#F9461C',
        defaults: {
            name: {value:""},
            interval: {value: "0", required: true, validate: RED.validators.number()},
            sense: {value: "", type:"sense-config", required:true}
        },
        inputs:0,
        outputs:1,
        icon: "sense.png",
        label: function() {
            return this.name||"sense update";
        },
        oneditprepare: function() {
            var node = this;

        }
    });
    RED.nodes.registerType('sense-trigger',{
        category: 'sense',
        color: '#F9461C',
        defaults: {
            name: {value:""},
            device: {value: 0, required: true},
            sense: {value: "", type:"sense-config", required:true}
        },
        inputs:0,
        outputs:2,
        icon: "sense.png",
        label: function() {
            return this.name||"sense trigger";
        },
        oneditprepare: function() {
            var node = this;

        }
    });
</script>

<script type="text/x-red" data-template-name="sense-config">
    <div class="form-row">
        <label for="node-config-input-name">Name</label>
        <input type="text" id="node-config-input-name">
    </div>
    <div class="form-row">
        <label for="node-config-input-email"><i class="icon-tag"></i> Sense Email</label>
        <input type="text" id="node-config-input-email">
    </div>
    <div class="form-row">
        <label for="node-config-input-password"><i class="icon-tag"></i> Sense Password</label>
        <input type="password" id="node-config-input-password">
    </div>
</script>


<script type="text/x-red" data-template-name="sense-device-on">
    <div class="form-row">
        <label for="node-input-sense"><i class="fa fa-globe"></i> Config</label>
        <input id="node-input-sense">
    </div>
    <div class="form-row">
        <label for="node-input-device"><i class="icon-tag"></i> Device</label>
        <input type="text" id="node-input-device" placeholder="Device Name or ID (optional)">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="icon-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
</script>

<script type="text/x-red" data-help-name="sense-device-on">
    <p>Using sense authentication configuration, check to see if given device is on. msg.payload should be a device name.</p>
</script>

<script type="text/x-red" data-template-name="sense-monitor">
    <div class="form-row">
        <label for="node-input-sense"><i class="fa fa-globe"></i> Config</label>
        <input id="node-input-sense">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="icon-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
</script>

<script type="text/x-red" data-help-name="sense-monitor">
    <p>Using sense authentication configuration, get information about the connected monitor.</p>
</script>

<script type="text/x-red" data-template-name="sense-now">
    <div class="form-row">
        <label for="node-input-sense"><i class="fa fa-globe"></i> Config</label>
        <input id="node-input-sense">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="icon-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
</script>

<script type="text/x-red" data-help-name="sense-now">
    <p>Using sense authentication configuration, get current live data one time.</p>
</script>


<script type="text/x-red" data-template-name="sense-trigger">
    <div class="form-row">
        <label for="node-input-sense"><i class="fa fa-globe"></i> Config</label>
        <input id="node-input-sense">
    </div>
    <div class="form-row">
        <label for="node-input-device"><i class="icon-tag"></i> Device</label>
        <input type="text" id="node-input-device" placeholder="Device Name or ID">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="icon-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
</script>

<script type="text/x-red" data-help-name="sense-trigger">
    <p>Using sense authentication configuration, call when device name/id is on or off.</p>
</script>

<script type="text/x-red" data-template-name="sense-devices">
    <div class="form-row">
        <label for="node-input-sense"><i class="fa fa-globe"></i> Config</label>
        <input id="node-input-sense">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="icon-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
</script>

<script type="text/x-red" data-help-name="sense-devices">
    <p>Using sense authentication configuration, get all known devices.</p>
</script>

<script type="text/x-red" data-template-name="sense-update">
    <div class="form-row">
        <label for="node-input-sense"><i class="fa fa-globe"></i> Config</label>
        <input id="node-input-sense">
    </div>
    <div class="form-row">
        <label for="node-input-interval"><i class="fa fa-fighter-jet"></i> Interval</label>
        <input type="text" id="node-input-interval" placeholder="Interval (delay in ms)">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="icon-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
</script>

<script type="text/x-red" data-help-name="sense-update">
    <p>Using sense authentication configuration, sends payload out whenever realtime data updates. msg.payload will be entire sense data.</p>
</script>